# åšå£«åç®¡ç†ç³»ç»Ÿå­¦ä¹ æŠ¥å‘Š (Postdoc Management System Learning Report)

## é¡¹ç›®æ¦‚è¿° (Project Overview)

è¿™æ˜¯ä¸€ä¸ªåŸºäº **FastAPI** å’Œ **PostgreSQL** çš„åšå£«åç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨ç°ä»£åŒ–çš„åç«¯æ¶æ„è®¾è®¡ï¼Œç”¨äºç®¡ç†åšå£«åç ”ç©¶äººå‘˜çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚

### ğŸ—ï¸ æŠ€æœ¯æ ˆ (Technology Stack)

**åç«¯ (Backend):**
- **FastAPI** - ç°ä»£ã€å¿«é€Ÿçš„ Web æ¡†æ¶
- **SQLAlchemy** - Python ORM æ¡†æ¶  
- **PostgreSQL** - ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“
- **SQLite** - æœ¬åœ°å¼€å‘æ•°æ®åº“
- **Alembic** - æ•°æ®åº“è¿ç§»å·¥å…·
- **JWT** - ç”¨æˆ·è®¤è¯
- **Pydantic** - æ•°æ®éªŒè¯
- **PassLib + BCrypt** - å¯†ç å“ˆå¸Œ

**å‰ç«¯ (Frontend):**
- ç›®å‰ä¸ºç©ºï¼Œè®¡åˆ’å¼€å‘

## ğŸ¯ ç³»ç»ŸåŠŸèƒ½èŒƒå›´ (System Scope)

æ ¹æ®æ–‡ä»¶åˆ†æï¼Œç³»ç»Ÿè®¾è®¡ç”¨äºç®¡ç†åšå£«åç ”ç©¶å‘˜çš„å®Œæ•´æµç¨‹ï¼š

### 1. ç”¨æˆ·ç®¡ç† (User Management)
- âœ… **å·²å®ç°**: ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€æƒé™ç®¡ç†
- âœ… **å·²å®ç°**: JWT èº«ä»½è®¤è¯
- âœ… **å·²å®ç°**: ç®¡ç†å‘˜ç”¨æˆ·ç®¡ç†

### 2. åšå£«åå…¨ç”Ÿå‘½å‘¨æœŸç®¡ç† (Postdoc Lifecycle Management)
åŸºäº `files/è¡¨ç»“æ„` ç›®å½•åˆ†æï¼š

**æ³¨å†Œé˜¶æ®µ (Registration Phase):**
- ğŸ“‹ ä¸ªäººä¿¡æ¯ç™»è®°
- ğŸ“‹ å…¥ç«™å‰æˆæœç™»è®°ï¼ˆè®ºæ–‡ã€ä¸“åˆ©ã€é¡¹ç›®ç­‰ï¼‰

**è¿›ç«™é˜¶æ®µ (Entry Phase):**
- ğŸ“‹ è¿›ç«™ç”³è¯·
- ğŸ“‹ å¹´åº¦è€ƒæ ¸  
- ğŸ“‹ ä¸­æœŸè€ƒæ ¸

**åœ¨ç«™ç®¡ç† (During Stay Management):**
- ğŸ“‹ è¿›ç«™åæˆæœè·Ÿè¸ªï¼ˆè®ºæ–‡ã€ä¸“åˆ©ã€é¡¹ç›®ç­‰ï¼‰
- ğŸ“‹ å¯¼å¸ˆè´¦å·åˆ†é…å’Œç®¡ç†

**å‡ºç«™é˜¶æ®µ (Exit Phase):**
- ğŸ“‹ å‡ºç«™ç”³è¯·
- ğŸ“‹ å»¶æœŸç”³è¯·

### 3. æˆæœç®¡ç†ç±»å‹ (Achievement Types)
- ğŸ“„ å­¦æœ¯è®ºæ–‡ (Academic Papers)
- ğŸ”¬ ä¸“åˆ©ä¿¡æ¯ (Patent Information)  
- ğŸ¯ å‚ä¸é¡¹ç›® (Project Participation)
- ğŸ† ç§‘ç ”ç«èµ› (Research Competitions)
- ğŸ“š è‘—ä½œä¿¡æ¯ (Publications)
- ğŸ“œ è¡Œä¸šæ ‡å‡† (Industry Standards)
- ğŸŒ± æ–°å“ç§ç±»å‹ (New Varieties)
- ğŸ¤ å­¦æœ¯ä¼šè®® (Academic Conferences)

## ğŸ›ï¸ æ¶æ„è®¾è®¡ (Architecture Design)

### åˆ†å±‚æ¶æ„ (Layered Architecture)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Router Layer  â”‚  â† HTTP å¤„ç†ã€å‚æ•°éªŒè¯ã€å“åº”æ ¼å¼åŒ–
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚  Service Layer  â”‚  â† ä¸šåŠ¡é€»è¾‘ã€æƒé™æ§åˆ¶ã€äº‹åŠ¡ç®¡ç†
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Model Layer   â”‚  â† æ•°æ®ç»“æ„ã€åŸºç¡€CRUDæ“ä½œ  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Database      â”‚  â† PostgreSQL/SQLite
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶ (Core Components)

**1. é…ç½®ç®¡ç† (Configuration)**
- `config.py` - ç”Ÿäº§ç¯å¢ƒé…ç½® (PostgreSQL)
- `config_local.py` - æœ¬åœ°å¼€å‘é…ç½® (SQLite)

**2. æ•°æ®åº“å±‚ (Database Layer)**
- `database.py` - SQLAlchemy å¼•æ“å’Œä¼šè¯ç®¡ç†
- `models/` - ORM æ•°æ®æ¨¡å‹å®šä¹‰

**3. ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer)**  
- `services/` - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å®ç°
- `dependencies.py` - ä¾èµ–æ³¨å…¥ç®¡ç†

**4. API æ¥å£å±‚ (API Layer)**
- `routers/` - HTTP è·¯ç”±å’Œç«¯ç‚¹å®šä¹‰
- `schemas/` - è¯·æ±‚/å“åº”æ•°æ®éªŒè¯

## ğŸ” è®¤è¯ç³»ç»Ÿ (Authentication System)

### JWT è®¤è¯æµç¨‹ (JWT Authentication Flow)

```
1. ç”¨æˆ·æ³¨å†Œ â†’ å¯†ç å“ˆå¸Œå­˜å‚¨
2. ç”¨æˆ·ç™»å½• â†’ å¯†ç éªŒè¯ â†’ ç”Ÿæˆ JWT Token  
3. è¯·æ±‚ API â†’ éªŒè¯ Token â†’ è·å–ç”¨æˆ·ä¿¡æ¯
4. æƒé™æ£€æŸ¥ â†’ æ‰§è¡Œä¸šåŠ¡é€»è¾‘
```

### è§’è‰²æƒé™ (Role-based Access Control)

- **admin** - ç®¡ç†å‘˜ï¼Œå¯ä»¥ç®¡ç†æ‰€æœ‰ç”¨æˆ·
- **user** - æ™®é€šç”¨æˆ·ï¼ŒåŸºç¡€åŠŸèƒ½è®¿é—®

## ğŸ“Š å½“å‰å®ç°çŠ¶æ€ (Current Implementation Status)

### âœ… å·²å®ŒæˆåŠŸèƒ½ (Completed Features)

1. **ç”¨æˆ·è®¤è¯ç³»ç»Ÿ**
   - ç”¨æˆ·æ³¨å†Œ (`POST /users/register`)
   - ç”¨æˆ·ç™»å½• (`POST /auth/login`) 
   - è·å–ç”¨æˆ·ä¿¡æ¯ (`GET /auth/me`)
   - ç®¡ç†å‘˜åˆ é™¤ç”¨æˆ· (`DELETE /users/{username}`)

2. **å®‰å…¨ç‰¹æ€§**
   - å¯†ç  BCrypt å“ˆå¸Œ
   - JWT Token è®¤è¯
   - åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶

3. **å¼€å‘ç¯å¢ƒ**
   - æœ¬åœ° SQLite å¼€å‘ç¯å¢ƒ
   - è‡ªåŠ¨ API æ–‡æ¡£ (Swagger UI)
   - æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

### ğŸš§ è®¡åˆ’å®ç° (Planned Features)

åŸºäºæ–‡ä»¶ç»“æ„åˆ†æï¼Œç³»ç»Ÿè®¡åˆ’å®ç°ï¼š

1. **åšå£«åä¿¡æ¯ç®¡ç†æ¨¡å—**
2. **æˆæœç®¡ç†æ¨¡å—** (è®ºæ–‡ã€ä¸“åˆ©ã€é¡¹ç›®ç­‰)
3. **è€ƒæ ¸ç®¡ç†æ¨¡å—** (å¹´åº¦ã€ä¸­æœŸè€ƒæ ¸)
4. **ç”³è¯·æµç¨‹ç®¡ç†** (è¿›ç«™ã€å‡ºç«™ã€å»¶æœŸ)
5. **å¯¼å¸ˆç®¡ç†æ¨¡å—**
6. **å‰ç«¯ç”¨æˆ·ç•Œé¢**

## ğŸ§ª æµ‹è¯•ä½¿ç”¨æŒ‡å— (Testing Guide)

### å¯åŠ¨æœ¬åœ°å¼€å‘ç¯å¢ƒ

```bash
# 1. å®‰è£…ä¾èµ–
cd server
pip3 install fastapi uvicorn sqlalchemy psycopg2-binary python-jose[cryptography] passlib[bcrypt] pydantic-settings alembic python-multipart

# 2. åˆå§‹åŒ–æ•°æ®åº“
python3 init_data.py

# 3. å¯åŠ¨æœåŠ¡å™¨
python3 -m uvicorn app.main_local:app --host 0.0.0.0 --port 8000 --reload

# 4. è®¿é—®APIæ–‡æ¡£
# http://localhost:8000/docs
```

### æµ‹è¯•è´¦æˆ· (Test Accounts)

| ç”¨æˆ·å | å¯†ç  | è§’è‰² | è¯´æ˜ |
|--------|------|------|------|
| admin | admin123 | admin | ç®¡ç†å‘˜è´¦æˆ· |
| åšå£«åå¼ ä¸‰ | zhang123 | user | æµ‹è¯•ç”¨æˆ· |
| åšå£«åæå›› | li123 | user | æµ‹è¯•ç”¨æˆ· |
| å¯¼å¸ˆç‹äº” | wang123 | user | æµ‹è¯•ç”¨æˆ· |

### API æµ‹è¯•ç¤ºä¾‹

```bash
# 1. ç”¨æˆ·ç™»å½•
curl -X POST "http://localhost:8000/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=admin&password=admin123"

# 2. è·å–ç”¨æˆ·ä¿¡æ¯  
curl -X GET "http://localhost:8000/auth/me" \
  -H "Authorization: Bearer YOUR_TOKEN"

# 3. æ³¨å†Œæ–°ç”¨æˆ·
curl -X POST "http://localhost:8000/users/register" \
  -H "Content-Type: application/json" \
  -d '{"username": "newuser", "password": "newpass123"}'
```

## ğŸ“ˆ å­¦ä¹ ä»·å€¼ (Learning Value)

è¿™ä¸ªé¡¹ç›®å±•ç¤ºäº†ä»¥ä¸‹ç°ä»£ Python Web å¼€å‘çš„æœ€ä½³å®è·µï¼š

### 1. **æ¶æ„è®¾è®¡**
- æ¸…æ™°çš„åˆ†å±‚æ¶æ„
- ä¾èµ–æ³¨å…¥æ¨¡å¼
- å…³æ³¨ç‚¹åˆ†ç¦»

### 2. **å®‰å…¨å®è·µ**  
- å¯†ç å®‰å…¨å“ˆå¸Œ
- JWT è®¤è¯æœºåˆ¶
- åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶

### 3. **å¼€å‘å·¥ç¨‹åŒ–**
- è‡ªåŠ¨APIæ–‡æ¡£ç”Ÿæˆ
- æ•°æ®éªŒè¯ (Pydantic)
- æ•°æ®åº“è¿ç§» (Alembic)
- é…ç½®ç®¡ç†

### 4. **å¯ç»´æŠ¤æ€§**
- æ¨¡å—åŒ–ä»£ç ç»„ç»‡
- ç±»å‹æ³¨è§£
- å®Œæ•´çš„é”™è¯¯å¤„ç†

## ğŸš€ æ‰©å±•å»ºè®® (Extension Suggestions)

1. **æ•°æ®æ¨¡å‹æ‰©å±•** - æ ¹æ®ä¸šåŠ¡éœ€æ±‚æ·»åŠ åšå£«åã€æˆæœç­‰æ¨¡å‹
2. **å‰ç«¯å¼€å‘** - Vue.js/React å•é¡µåº”ç”¨
3. **æµ‹è¯•æ¡†æ¶** - pytest å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•  
4. **CI/CD** - è‡ªåŠ¨åŒ–éƒ¨ç½²æµæ°´çº¿
5. **ç›‘æ§æ—¥å¿—** - åº”ç”¨æ€§èƒ½ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ
6. **API ç‰ˆæœ¬æ§åˆ¶** - æ”¯æŒå¤šç‰ˆæœ¬ API
7. **ç¼“å­˜ç­–ç•¥** - Redis ç¼“å­˜ä¼˜åŒ–æ€§èƒ½

## ğŸ“ æ€»ç»“ (Summary)

è¿™ä¸ªåšå£«åç®¡ç†ç³»ç»Ÿé¡¹ç›®å…·æœ‰è‰¯å¥½çš„æ¶æ„åŸºç¡€å’Œæ˜ç¡®çš„ä¸šåŠ¡ç›®æ ‡ã€‚å½“å‰å·²å®ç°çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿå±•ç¤ºäº†ç°ä»£ Python Web å¼€å‘çš„æ ‡å‡†å®è·µï¼Œä¸ºåç»­åŠŸèƒ½å¼€å‘æä¾›äº†åšå®çš„åŸºç¡€ã€‚è¯¥é¡¹ç›®å¯¹å­¦ä¹  FastAPIã€SQLAlchemyã€JWT è®¤è¯ç­‰æŠ€æœ¯å…·æœ‰å¾ˆé«˜çš„å‚è€ƒä»·å€¼ã€‚